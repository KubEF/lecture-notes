% !TeX root = ./main.tex
\documentclass[main]{subfiles}
\begin{document}
\chapter{Соприкасающийся параболоид}
Сейчас идея такая: хотим заменить поверхность на параболоид, так чтобы в данной конкретной точке $\fff, \sff$ квадратичные формы и все, что с ними связано не изменились.
Попробуем её реализовать.

Пусть у нас есть поверхность и точка $M$ на ней.
Введем координаты:
\begin{itemize}
    \item точка $M = (0,0,0)$
    \item $T_M = OXY$ -- касательная плоскость к точке $M$ поверхности это $OXY$
    \item $\vn_M = (0,0,1)$
\end{itemize}
\begin{center}
    \import{figures}{touching_paraboloid.pdf_tex}
\end{center}
Тогда можем параметризовать поверхность таким образом $z = f(x,y)$, по крайней мере в окрестности точки $M$.

Рассмотрим некоторое приближение этой поверхности, для этого применим формулу Тейлора:
\begin{align*}
    z & = \vf(x,y)                                                       \\
      & = \vf(x_0,y_0) + \vf'_x(x_0,y_0)(x-x_0) + \vf'_y(x_0,y_0)(y-y_0) \\
      & + \frac{\vf''_{xx}(x_0,y_0)}{2!}(x-x_0)^2                        \\
      & + \frac{2 \vf''_{xy}(x_0,y_0)}{2!}(x- x_0)(y-y_0)                \\
      & + \frac{\vf''_{yy}(x_0,y_0)}{2!}(y-y_0)^2                        \\
      & +o((x-x_0)^2 +(y-y_0)^2)
\end{align*}
Т.к. $M = (0,0,0)$, то $\vf(x_0,y_0) = 0$.
Из того, что $T_M = OXY$, следует, что $\vf'_x(0,0) = \vf'_y(0,0)=0$, тогда формула Тейлора приобретает вид:
\[z = \frac{\vf''_{xx}(0,0)}{2}x^2 + \vf''_{xy}xy + \frac{\vf''_{yy}(0,0)}{2} y^2 + o(x^2 + y^2)\]
Это в точности уравнение параболоида.
\begin{definition}[Соприкасающийся параболоид]
    Этот параболоид называется соприкасающимся параболоидом.
    Повернем $OXY$, так чтобы  слагаемое при $xy$ исчезло, получим:
    \[z = Ax^2 + Cy^2\]
    Считаем, что
    \begin{align*}
        \vf''_{xx}(0,0) & = 2A & \vf''_{yy}(0,0) & =2C & \vf''_{xy}(0,0) = 0
    \end{align*}
\end{definition}

Рассмотрим $\vf_1(x,y) = Ax^2 + Cy^2$\marginpar{07.11.22}
\begin{gather*}
    \left.\frac{\partial \vf}{\partial x} \right| _{(0,0)} = \left.\frac{\partial \vf_1}{\partial x} \right|_{(0,0)}\\
    \left.\frac{\partial^2 \vf}{\partial x^2} \right|_{(0,0)} = \left.\frac{\partial^2 \vf_1}{\partial x^2} \right|_{(0,0)}
\end{gather*}
и т.д., таким образом приходим к теореме:
\begin{theorem}
    $\fff$ и $\sff$ квадратичные формы у поверхности и соприкасающегося параболоида в данной точке одинаковы.
\end{theorem}
Теорема очевидна, рассмотрим векторную форму поверхности $z = \vf(x,y)$: $\vr(x,y,\vf(x,y))$.
\begin{gather*}
    E = \frac{\partial \vr}{\partial x} \frac{\partial \vr}{\partial x} = \left(1 + \left|\frac{\partial \vf}{\partial x} \right|_{(0,0)}\right) = 1\\
    F = 0 \\
    G= 1\\
    L = \frac{\partial^2 \vf}{\partial x^2} \vn = (0,0,2A) \cdot (0,0,1) = 2A\\
    M = (0,0,\vf''_{xy}|_{(0,0)})\vn = 0\\
    N =  2C
\end{gather*}
Но это только в одной конкретной точке, даже не в окрестности.
\begin{corollary}
    $k_{n}, k_1, k_2, K, H$ одинаковы у поверхности и соприкасающегося параболоида.
\end{corollary}

Когда нам нужно что-то сосчитать попробуем заменить поверхность на соприкасающийся параболоид.
\begin{theorem}[Эйлера]
    \[k_{n} (\theta) = k_1 \cos^2 \theta + k_2 \sin^2 \theta\]
\end{theorem}
\begin{center}
    \import{figures}{euler_theorem.pdf_tex}
\end{center}
$k_1, k_2$ -- нормальные кривизны, в направлениях $OX$ и $OY$ в выбранной системе координат.

Посмотрим на нормальную кривизну в направлении $\theta$:
\[k_{n} (\theta) = \frac{\sff(\cos \theta, \sin \theta)}{\fff(\cos \theta, \sin \theta)} = \frac{2A \cos^2 \theta + 2C \sin^2 \theta}{\cos^2\theta + \sin^2 \theta}\]
в нашем определении
\begin{align*}
    \theta & = 0             & 2A & = k_1 \\
    \theta & = \frac{\pi}{2} & 2C & = k_2
\end{align*}
Докажем, что $k_1, k_2$ -- главные кривизны.
Для этого исследуем $k_{n}(\theta)$ на минимум и максимум:
\begin{gather*}
    k_{n}(\theta) = k_1 \cos^2 \theta + k_2(1- \cos^2 \theta) = (k_1 - k_2) \cos^2 \theta + k_2.
\end{gather*}
\begin{itemize}
    \item Если $k_1 \ge k_2$
          \begin{description}
              \item[минимум] при $\cos^2\theta = 0$ и $k_{n} = k_2$
              \item[максимум] при $\cos^2\theta = 1$ и $k_{n} = k_1$
          \end{description}
    \item Если $k_1 \le k_2$, то минимум и максимум меняются местами
\end{itemize}
\begin{corollary}
    Главные направления перпендикулярны.
\end{corollary}
\begin{corollary}
    Направления $\theta$ и $\pi - \theta$ имеют одинаковые нормальные кривизны.
\end{corollary}

\begin{remark}
    $K = 4AC$
\end{remark}
Каким может быть параболоид $z = Ax^2 + Cy^2$?


\begin{enumerate}
    \item Если $A, C$ -- одного знака, то параболоид эллиптический $\Leftrightarrow K > 0$, такая точка называется эллиптической
          \begin{itemize}
              \item Если $A=C$, то это параболоид вращения (в любом направлении одинаковые кривизна), такая точка -- точка округления
          \end{itemize}
    \item Если $A,C$ -- разных знаков, то параболоид гиперболический $\Leftrightarrow K < 0$ и эта точка называется гиперболической
    \item Если $A =0$ или $C=0$ $\Leftrightarrow K = 0$, то параболоид является параболическим цилиндром, и такая точка называется параболической
          \begin{itemize}
              \item если $A = C = 0$, параболоид является плоскостью, и точка называется точкой уплощения
          \end{itemize}
\end{enumerate}


\section{Вычисление главных направлений}
Выберем направление $(\xi, \eta)$ в области $\fancyD$:
\begin{center}
    \import{figures}{xi_eta_direction.pdf_tex}
\end{center}

Введем замену $x = \xi / \eta$
\[k_{n}(\xi, \eta) = \frac{\sff(\xi, \eta)}{\fff(\xi, \eta)} = \frac{L \xi^2 + 2M \xi\eta + N \eta^2}{E \xi^2 + 2F \xi\eta + G \eta^2} = \frac{L x^2 + 2Mx+N}{E x^2 + 2 Fx + G}\]
Хотим вычислить главные направления, т.е. понять при каких $x$, $\xi$ и $\eta$ задают главные направления, т.к. $x = \tg \theta$, где $\theta$ -- угол с произвольным направлением.
Для этого найдем минимум и максимум:
\begin{gather*}
    \begin{multlined}
        \left(k_{n}(x)\right)' =\\
        = \frac{(2Lx + 2M)(Ex^2 + 2Fx +G) - (2Ex + 2F)(Lx^2 + 2Mx+N)}{(Ex^2 + 2Fx + G)^2}
        = 0
    \end{multlined}\\
    Ex^2 + 2Fx + G >0 \text{ т.к. } \frac{D}{4} = F^2 -EG < 0\\
    \left( \sqrt{EG - F^2} = | \vr'_u \times \vr'_v| \right)\\
    \intertext{в таком случае приравняем к нулю числитель}
    (Lx + M) (Ex^2 + 2Fx + G) - (Ex+F) (Lx^2 + 2Mx + N) = 0\\
    \begin{multlined}
        2LFx^2 + LGx + MEx^2 + 2MFx + MG -\\
        -  2MEx^2 - NEx  - FLx^2 - 2FMx -FN = 0
    \end{multlined}\\
    (FL - ME)x^2 + (LG-NE)x + (MG - FN) = 0\\
    \intertext{решать данное уравнение неудобно, сделаем обратную замену и домножим на $\eta^2$}
    (FL-ME)\xi^2 + (LG-NE)\xi\eta + (MG-FN)\eta^2 = 0\\
    \intertext{и это равенство можно записать в виде}
    \begin{vmatrix}
        \xi^2 & -\xi\eta & \eta^2 \\
        G     & F        & E      \\
        N     & M        & L
    \end{vmatrix} = 0
\end{gather*}
\section{Вычисление главных кривизн}
\begin{gather*}
    k = \frac{Lx^2 + 2Mx + N}{Ex^2 + 2Fx + G}\\
    \intertext{запишем в другом виде}
    Lx^2 + 2Mx + N = k(Ex^2 + 2Fx +G)\\
    \intertext{если нам дано $k$, то это просто квадратное уравнение}
    (L - kE)x^2 + 2(M-kF)x + (N-kG) = 0
\end{gather*}

Если $k$ не главная кривизна, то у этого уравнения есть 2 решения,

Если $k$ главная кривизна -- 1 решение,

Если $k$ не кривизна -- 0 решений, такое может быть, т.к. нормальная кривизна может быть заключена только между главными кривизнами.

Т.к. мы ищем главные кривизны, то необходимое для нас условие: $D/4 = 0$, то есть
\begin{gather*}
    (M-kF)^2 - (L -kE)(N-kG) = 0\\
    k^2 (F^2 -EG) - k(2MF - LG - EN) + (M^2 -LN) = 0
\end{gather*}
$k_1, k_2$ -- корни соответствующего уравнения
\begin{gather*}
    K = k_1 k_2 = \frac{M^2 - LN}{F^2 - EG} = \frac{LN - M^2}{EG - F^2}\\
    H = \frac{2MF - LG - EN}{2(F^2 - EG)}
\end{gather*}
\section{Блистательная теорема Гаусса}
\begin{lemma}\label{touching_paraboloid:cross_product_lemma}
    $\va, \vb, \vc, \vd, \ve, \vf$ -- векторы.
    \[(\va, \vb, \vc)(\vd, \ve,\vf) = \begin{vmatrix}
            \va\vd & \va\ve & \va\vf \\
            \vb\vd & \vb\ve & \vb\vf \\
            \vc\vd & \vc\ve & \vc\vf
        \end{vmatrix}\]
\end{lemma}
\begin{proof}
    $\va = (a_1, a_2, a_3)$ и так далее
    \begin{multline*}
        (\va, \vb, \vc)(\vd, \ve, \vf) = \begin{vmatrix}
            a_1 & a_2 & a_3 \\
            b_1 & b_2 & b_3 \\
            c_1 & c_2 & c_3
        \end{vmatrix}
        \begin{vmatrix}
            d_1 & e_1 & f_1 \\
            d_2 & e_2 & f_2 \\
            d_3 & e_3 & f_3
        \end{vmatrix}
        = \\
        \det \left( \begin{pmatrix}
            a_1 & a_2 & a_3 \\
            b_1 & b_2 & b_3 \\
            c_1 & c_2 & c_3
        \end{pmatrix}
        \begin{pmatrix}
            d_1 & e_1 & f_1 \\
            d_2 & e_2 & f_2 \\
            d_3 & e_3 & f_3
        \end{pmatrix}\right) =
        \begin{vmatrix}
            \va\vd & \va\ve & \va\vf \\
            \vb\vd & \vb\ve & \vb\vf \\
            \vc\vd & \vc\ve & \vc\vf
        \end{vmatrix}
    \end{multline*}
\end{proof}

\begin{lemma}
    \[\begin{vmatrix}
            A_1 + A_2 & B_1 + B_2 & C_1 + C_2 \\
            D         & E         & F         \\
            \alpha    & \beta     & \gamma
        \end{vmatrix} =
        \begin{vmatrix}
            A_1    & B_1   & C_1    \\
            D      & E     & F      \\
            \alpha & \beta & \gamma
        \end{vmatrix} +
        \begin{vmatrix}
            A_2    & B_2   & C_2    \\
            D      & E     & F      \\
            \alpha & \beta & \gamma
        \end{vmatrix}\]
\end{lemma}
\begin{proof}
    \begin{multline*}
        \begin{vmatrix}
            A_1 + A_2 & B_1 + B_2 & C_1 + C_2 \\
            D         & E         & F         \\
            \alpha    & \beta     & \gamma
        \end{vmatrix} =\\
        (A_1 + A_2) \begin{vmatrix}
            E     & F      \\
            \beta & \gamma
        \end{vmatrix}
        - (B_1 + B_2) \begin{vmatrix}
            D      & F      \\
            \alpha & \gamma
        \end{vmatrix}
        + (C_1 + C_2) \begin{vmatrix}
            D      & E     \\
            \alpha & \beta
        \end{vmatrix}=\\
        \begin{vmatrix}
            A_1    & B_1   & C_1    \\
            D      & E     & F      \\
            \alpha & \beta & \gamma
        \end{vmatrix} +
        \begin{vmatrix}
            A_2    & B_2   & C_2    \\
            D      & E     & F      \\
            \alpha & \beta & \gamma
        \end{vmatrix}
    \end{multline*}
\end{proof}
\begin{theorem}\label{touching_paraboloid:gauss}
    \[K = \frac{LN - M^2}{EG - F^2}\]
\end{theorem}
\begin{longProof}
    Хотим выразить $LN-M^2$ через $E, F, G$ и их производные.
    Вспомним:
    \begin{align*}
        L(u,v) & \coloneqq \vf''_{uu} \vn &
        M(u,v) & \coloneqq \vf''_{uv} \vn &
        N(u,v) & \coloneqq \vf''_{vv} \vn
    \end{align*}
    Что же такое $\vn$?
    \begin{gather*}
        \vn = \frac{\vf'_u \times \vf'_v}{|\vf'_u \times \vf'_v|} = \frac{\vf'_u \times \vf'_v}{\sqrt{EG-F^2}}\\
        \intertext{тогда}
        L = \frac{(\vf'_u \times \vf'_v)\vf''_{uu}}{\sqrt{EG-F^2}} = \frac{(\vf''_{uu}, \vf'_u, \vf'_v)}{\sqrt{EG-F^2}}\\
        M = \frac{(\vf''_{uv}, \vf'_u, \vf'_v)}{\sqrt{EG-F^2}}\\
        N = \frac{(\vf''_{vv}, \vf'_u, \vf'_v)}{\sqrt{EG-F^2}}\\
        LN-M^2 = \frac{(\vf''_{uu}, \vf'_u, \vf'_v)(\vf''_{vv}, \vf'_u, \vf'_v) - (\vf''_{uv}, \vf'_u, \vf'_v)(\vf''_{uv}, \vf'_u, \vf'_v)}{EG-F^2}
    \end{gather*}
    Теперь выразим
    \[(\vf''_{uu}, \vf'_u, \vf'_v)(\vf''_{vv}, \vf'_u, \vf'_v) - (\vf''_{uv}, \vf'_u, \vf'_v)(\vf''_{uv}, \vf'_u, \vf'_v)\]
    через коэффициенты $\fff$ формы. Применим лемму \ref{touching_paraboloid:cross_product_lemma}, тогда
    \begin{multline*}
        (\vf''_{uu}, \vf'_u, \vf'_v)(\vf''_{vv}, \vf'_u, \vf'_v) - (\vf''_{uv}, \vf'_u, \vf'_v)(\vf''_{uv}, \vf'_u, \vf'_v) = \\
        =\begin{vmatrix}
            \vf''_{uu} \vf''_{vv} & \vf''_{uu} \vf'_u & \vf''_{uu}\vf'_v \\
            \vf'_u \vf''_{vv}     & \vf'_u\vf'_u      & \vf'_u \vf'_v    \\
            \vf'_v \vf''_{vv}     & \vf'_v\vf'_u      & \vf'_v \vf'_v
        \end{vmatrix} -
        \begin{vmatrix}
            \vf''_{uv} \vf''_{uv} & \vf''_{uv} \vf'_u & \vf''_{uv}\vf'_v \\
            \vf'_u \vf''_{uv}     & \vf'_u\vf'_u      & \vf'_u \vf'_v    \\
            \vf'_v \vf''_{uv}     & \vf'_v\vf'_u      & \vf'_v \vf'_v
        \end{vmatrix}= \\
        = \begin{vmatrix}
            \vf''_{uu} \vf''_{vv}  & \frac{1}{2}E'_u & F'_u - \frac{1}{2}E'_v \\
            F'_v - \frac{1}{2}G'_u & E               & F                      \\
            \frac{1}{2}G'_v        & F               & G
        \end{vmatrix}-
        \begin{vmatrix}
            \vf''_{uv}\vf''_{uv} & \frac{1}{2} E'_v & \frac{1}{2} G'_u \\
            \frac{1}{2} E'_v     & E                & F                \\
            \frac{1}{2} G'_u     & F                & G
        \end{vmatrix}
    \end{multline*}
    где последнее равенство следует из формул:
    \begin{align*}
        E'_u & = (\vf'_u, \vf'_u)'_u = 2\vf'_u \vf''_{uu} & F'_u              & = (\vf_u, \vf_v)'_u = \vf''_{uu}\vf'_v + \vf'_u \vf'_{vu} \\
        E'_v & = (\vf'_u, \vf'_u)'_v = 2\vf'_u \vf''_{uv} & F'_v              & = \vf''_{uv}\vf'_v + \vf'_u \vf'_{vv}                     \\
        G'_u & = 2 \vf'_v \vf''_{uv}                      & \vf''_{uu}\vf'_v  & = F'_u - \frac{1}{2}E'_v                                  \\
        G'_v & = 2 \vf'_v \vf''_{vv}                      & \vf'_u \vf''_{vv} & = F'_v - \frac{1}{2}G'_u
    \end{align*}
    Отдельно взятый, каждый определитель не выражается через коэффициенты $\fff$ формы.
    Разложим определители по первой строке:
    \begin{multline*}
        \vf''_{uu} \vf''_{vv} \begin{vmatrix}
            E & F \\
            F & G
        \end{vmatrix}
        - \frac{1}{2} E'_u \begin{vmatrix}
            F'_v - \frac{1}{2}G'_u & F \\
            \frac{1}{2}G'_u        & G
        \end{vmatrix}
        + \left(F'_u - \frac{1}{2} E'_v\right) \begin{vmatrix}
            F'_v - \frac{1}{2} G'_u & E \\
            \frac{1}{2}G'_v         & F
        \end{vmatrix}-\\
        - \vf''_{uv} \vf''_{uv} \begin{vmatrix}
            E & F \\
            F & G
        \end{vmatrix}
        + \frac{1}{2} E'_v \begin{vmatrix}
            F'_v - \frac{1}{2}G'_u & F \\
            \frac{1}{2}G'_v        & G
        \end{vmatrix}
        - \frac{1}{2} G'_u \begin{vmatrix}
            F'_v - \frac{1}{2}G'_u & E \\
            \frac{1}{2}G'_v        & F
        \end{vmatrix}
    \end{multline*}
    Нас интересуют только $\vf''_{uu}\vf''_{vv} - \vf''^2_{uv}$, т.к. все остальное уже зависит только от $\fff$ квадратичной формы.
    Возьмем вторые производные $E,F,G$:
    \begin{gather*}
        E''_{vv} = 2 (\vf''_{uv} \vf''_{uv} + \vf'_u \vf'''_{uvv})\\
        G''_{uu} = 2 (\vf''_{uv} \vf''_{uv} + \vf'_v \vf'''_{uuv})\\
        % Кажется они не нужны в итоге
        % F''_{uu} = \vf'''_{uuu} \vf'_v + 2 \vf''_{uu} \vf''_{uv} + \vf'_u \vf'''_{uuv}\\
        % F''_{vv} = \vf'''_{vvv} \vf'_u + 2 \vf''_{vv} \vf''_{uv} + \vf'_v \vf'''_{uvv}\\
        F''_{uv} = \vf'''_{uuv} \vf'_v + \vf''_{uu} \vf''_{vv} + \vf'_u \vf'''_{uvv} + \vf''_{uv} \vf''_{uv}\\
    \end{gather*}
    Итого
    \[\vf''_{uu}\vf''_{vv} - \vf''^2_{uv} = F''_{uv}- \vf'_v\vf'''_{uuv} - \vf'_u \vf'''_{uvv} - 2 \vf''^2_{uv} = F''_{uv} - \frac{1}{2}G''_{uu} - \frac{1}{2} E''_{vv}\]
\end{longProof}
\end{document}